# 🧪 遊戲內自動化測試系統

## ✅ 已完成！

測試指令系統已經創建並編譯成功！

---

## 🚀 使用方法

### 1. 啟動遊戲

```bash
.\gradlew runClient
```

### 2. 進入遊戲後，在聊天窗口輸入指令

---

## 📝 可用指令

### **測試所有機器**
```
/test all
```
自動測試所有機器的功能和數據同步，並生成完整報告。

**輸出範例**：
```
========================================
🧪 開始測試所有機器...
========================================

🔥 測試魔力發電機...
  ✅ BlockEntity 創建成功
  ✅ SyncHelper 初始化成功
  ✅ 模式切換成功 (0 → 1)
  ✅ 數據同步正確
  ✅ 能量存儲初始化成功
📊 魔力發電機: 5/5 通過

⚗️ 測試魔力注入機...
  ✅ BlockEntity 創建成功
  ✅ SyncHelper 初始化成功
  ✅ 魔力存儲正常 (最大: 10000)
  ✅ 數據同步正確
  ✅ 配方系統初始化成功
📊 魔力注入機: 5/5 通過

========================================
📊 測試完成: 10/10 通過
✅ 所有測試通過！
========================================
```

---

### **測試單個機器**

#### 測試魔力發電機
```
/test mana_generator
```

測試項目：
- BlockEntity 創建
- SyncHelper 初始化
- 模式切換功能
- 數據同步正確性
- 能量存儲系統

#### 測試魔力注入機
```
/test mana_infuser
```

測試項目：
- BlockEntity 創建
- SyncHelper 初始化
- 魔力存儲容量
- 數據同步正確性
- 配方系統

---

### **測試數據同步系統**
```
/test sync
```

檢查 MachineSyncManager 和 SyncHelper 是否正常運作。

---

## 🎯 測試內容詳解

### **魔力發電機測試**

1. **BlockEntity 創建** - 驗證方塊實體正確生成
2. **SyncHelper 初始化** - 確認同步助手不為 null
3. **模式切換** - 測試 toggleMode() 功能
4. **數據同步** - 驗證模式切換後數據正確同步
5. **能量存儲** - 檢查魔力和能量存儲初始化

### **魔力注入機測試**

1. **BlockEntity 創建** - 驗證方塊實體正確生成
2. **SyncHelper 初始化** - 確認同步助手不為 null
3. **魔力存儲** - 檢查魔力容量是否正確
4. **數據同步** - 驗證魔力值正確同步
5. **配方系統** - 檢查配方處理器初始化

---

## 💡 工作原理

測試指令會：

1. **自動放置機器方塊** - 在玩家上方放置測試方塊
2. **獲取 BlockEntity** - 檢查方塊實體是否正確創建
3. **執行功能測試** - 調用各種方法並驗證結果
4. **驗證數據同步** - 確認 SyncHelper 數據與實際數據一致
5. **自動清理** - 測試完成後移除測試方塊
6. **生成報告** - 在聊天窗口顯示測試結果

---

## ⚡ 優勢

### 相比手動測試：
- ✅ **速度快** - 全自動測試只需 5-10 秒
- ✅ **覆蓋全** - 測試所有關鍵功能
- ✅ **可重複** - 隨時運行，結果一致
- ✅ **詳細報告** - 清楚顯示哪裡通過/失敗
- ✅ **無需 GUI** - 不用手動打開每個機器界面

### 手動測試流程（10+ 分鐘）：
```
1. 給自己機器方塊
2. 放置方塊
3. 右鍵打開 GUI
4. 測試按鈕
5. 檢查數值
6. 破壞方塊
7. 重複步驟 1-6 for 每個機器
```

### 自動化測試流程（10 秒）：
```
1. 輸入 /test all
2. 查看結果
```

**節省 98% 的時間！** ⚡

---

## 🔧 添加更多測試

如果你想為新機器添加測試，只需要：

1. 在 `TestCommand.java` 中添加新的測試方法
2. 在 `/test all` 中調用它
3. 重新編譯

範例：
```java
private static TestResult testNewMachine(ServerPlayer player, ServerLevel level) {
    player.sendSystemMessage(Component.literal("§e🔧 測試新機器..."));

    TestResult result = new TestResult();
    // ... 添加測試邏輯

    return result;
}
```

---

## 📊 測試報告說明

### 成功輸出
```
✅ 所有測試通過！
```
所有機器功能正常，數據同步正確。

### 失敗輸出
```
❌ 有 2 個測試失敗
```
檢查聊天記錄中的紅色 ❌ 標記，查看具體哪個測試失敗了。

---

## 🎮 立即開始測試

1. **構建遊戲**：
   ```bash
   .\gradlew build
   ```

2. **啟動遊戲**：
   ```bash
   .\gradlew runClient
   ```

3. **進入遊戲後輸入**：
   ```
   /test all
   ```

4. **查看測試結果** - 10 秒內得到完整報告！

---

## 🐛 如果測試失敗

測試失敗時會顯示詳細錯誤信息，例如：

```
❌ 數據同步錯誤 (期望: 1, 實際: 0)
```

這表示：
- **期望值**: 1（模式切換後應該是模式 1）
- **實際值**: 0（但同步後仍然是模式 0）
- **問題**: SyncHelper 沒有正確同步數據

根據錯誤信息，你可以快速定位問題所在。

---

**現在你可以隨時用 `/test all` 快速驗證所有機器功能！** 🎉
