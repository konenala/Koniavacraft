# å„€å¼ç³»çµ±ç¾æ³å ±å‘Š

> æ›´æ–°æ—¥æœŸï¼š2025-10-02
> æª¢æŸ¥è€…ï¼šClaude Code

---

## ğŸ“Š ç³»çµ±å®Œæˆåº¦ç¸½è¦½

### âœ… å·²å®Œæˆ (95%)

| æ¨¡çµ„ | å®Œæˆåº¦ | å‚™è¨» |
|------|--------|------|
| **æ ¸å¿ƒçµæ§‹** | 100% | æ‰€æœ‰æ–¹å¡Šèˆ‡æ–¹å¡Šå¯¦é«”å®Œæ•´ |
| **é©—è­‰ç³»çµ±** | 100% | çµæ§‹èˆ‡ææ–™é©—è­‰å®Œæ•´ |
| **é…æ–¹ç³»çµ±** | 100% | ç¨‹å¼é‚è¼¯å®Œæ•´ |
| **æ¸²æŸ“ç³»çµ±** | 100% | åŸºåº§ç‰©å“æ¸²æŸ“ã€ç²’å­æ•ˆæœå®Œæ•´ |
| **é…æ–¹è¨»å†Š** | 100% | `ModRecipes` æ­£ç¢ºè¨»å†Š |
| **é…æ–¹å»ºæ§‹å™¨** | 100% | `RitualRecipeBuilder` å®Œæ•´ |
| **é è¨­é…æ–¹** | 100% | `RitualRecipeProvider` æœ‰ 4 å€‹ç­‰ç´šç¯„ä¾‹ |

### âŒ ç¼ºå°‘çš„éƒ¨åˆ† (5%)

| å•é¡Œ | åš´é‡ç¨‹åº¦ | å½±éŸ¿ |
|------|---------|------|
| **é…æ–¹æ•¸æ“šç”Ÿæˆæœªå•Ÿç”¨** | ğŸ”´ é«˜ | éŠæˆ²ä¸­ç„¡æ³•ä½¿ç”¨å„€å¼ |

---

## ğŸ” å•é¡Œè©³ç´°åˆ†æ

### å•é¡Œï¼šé…æ–¹ JSON æª”æ¡ˆæœªç”Ÿæˆ

**ç¾è±¡**ï¼š
- âœ… `RitualRecipeProvider.java` å·²ç¶“å¯«å¥½ï¼ˆåŒ…å« 4 å€‹ç­‰ç´šçš„ç¯„ä¾‹é…æ–¹ï¼‰
- âœ… `RitualRecipeBuilder.java` å·¥å…·é¡å®Œæ•´
- âœ… `ModRecipes.java` æ­£ç¢ºè¨»å†Šäº† `RITUAL_TYPE` å’Œ `RITUAL_SERIALIZER`
- âŒ **ä½†æ˜¯** `src/generated/resources/data/koniava/recipe/ritual/` ç›®éŒ„ä¸å­˜åœ¨
- âŒ **æ²’æœ‰** ä»»ä½• `*.json` é…æ–¹æª”æ¡ˆè¢«ç”Ÿæˆ

**æ ¹æœ¬åŸå› **ï¼š
`RitualRecipeProvider.generate(recipeOutput)` **æ²’æœ‰åœ¨ `ModRecipeProvider.buildRecipes()` ä¸­è¢«å‘¼å«**ï¼

**è­‰æ“š**ï¼š
æŸ¥çœ‹ `ModRecipeProvider.java` ç¬¬ 28-42 è¡Œï¼š
```java
@Override
protected void buildRecipes(RecipeOutput recipeOutput) {
    // === ğŸ”¥ å§”æ´¾çµ¦å°ˆé–€çš„æä¾›è€… ===
    MaterialProcessingRecipeProvider.generate(recipeOutput);
    ManaFuelRecipeProvider.generate(recipeOutput);
    ManaCraftingRecipeProvider.generate(recipeOutput);
    ManaInfuserRecipeProvider.generate(recipeOutput);

    // âŒ ç¼ºå°‘é€™è¡Œï¼š
    // RitualRecipeProvider.generate(recipeOutput);

    // === ğŸ“‹ å‰©é¤˜çš„ä¸»è¦é…æ–¹é¡åˆ¥ ===
    generateMachineRecipes(recipeOutput);
    generateUpgradeRecipes(recipeOutput);
    ...
}
```

---

## ğŸ› ï¸ ä¿®å¾©æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šå•Ÿç”¨å„€å¼é…æ–¹ç”Ÿæˆï¼ˆæ¨è–¦ï¼‰

**æ­¥é©Ÿ 1**ï¼šä¿®æ”¹ `ModRecipeProvider.java`

åœ¨ `buildRecipes()` æ–¹æ³•ä¸­ï¼Œç¬¬ 33 è¡Œå¾Œé¢åŠ å…¥ï¼š

```java
@Override
protected void buildRecipes(RecipeOutput recipeOutput) {
    // === ğŸ”¥ å§”æ´¾çµ¦å°ˆé–€çš„æä¾›è€… ===
    MaterialProcessingRecipeProvider.generate(recipeOutput);
    ManaFuelRecipeProvider.generate(recipeOutput);
    ManaCraftingRecipeProvider.generate(recipeOutput);
    ManaInfuserRecipeProvider.generate(recipeOutput);

    // âœ… æ–°å¢é€™è¡Œ
    com.github.nalamodikk.common.datagen.recipe.ritual.RitualRecipeProvider.generate(recipeOutput);

    // === ğŸ“‹ å‰©é¤˜çš„ä¸»è¦é…æ–¹é¡åˆ¥ ===
    generateMachineRecipes(recipeOutput);
    ...
}
```

**æ­¥é©Ÿ 2**ï¼šåŸ·è¡Œè³‡æ–™ç”Ÿæˆ

```powershell
.\gradlew.bat runData
```

**æ­¥é©Ÿ 3**ï¼šé©—è­‰çµæœ

æª¢æŸ¥æ˜¯å¦ç”Ÿæˆäº†ä»¥ä¸‹æª”æ¡ˆï¼š
- `src/generated/resources/data/koniava/recipe/ritual/arcane_alloy_birth.json`
- `src/generated/resources/data/koniava/recipe/ritual/livingwood_creation.json`
- `src/generated/resources/data/koniava/recipe/ritual/mana_lens_refinement.json`
- `src/generated/resources/data/koniava/recipe/ritual/efficiency_rune_inscription.json`
- `src/generated/resources/data/koniava/recipe/ritual/starmetal_forging.json`
- `src/generated/resources/data/koniava/recipe/ritual/void_pearl_fracture.json`
- `src/generated/resources/data/koniava/recipe/ritual/heart_of_the_world.json`

---

## ğŸ“‹ å·²å¯¦ç¾çš„é…æ–¹æ¸…å–®

### Tier 1 - åŸºç¤å„€å¼

#### 1. å¥§è¡“åˆé‡‘çš„èª•ç”Ÿ (`arcane_alloy_birth`)
- **ææ–™**ï¼š4x éµéŒ ã€4x é’é‡‘çŸ³
- **ç”¢å‡º**ï¼š4x é­”åŠ›éŒ 
- **é­”åŠ›æ¶ˆè€—**ï¼š5,000
- **æ™‚é–“**ï¼š200 tick (10ç§’)
- **çµæ§‹éœ€æ±‚**ï¼š4 å€‹åŸºåº§ã€1 å€‹æ ¸å¿ƒ

#### 2. æ´»åŒ–æœ¨æ (`livingwood_creation`)
- **ææ–™**ï¼š16x åŸæœ¨ï¼ˆæ©¡æœ¨/æ¨ºæœ¨/é›²æ‰ï¼‰ã€2x ç¶ å¯¶çŸ³
- **ç”¢å‡º**ï¼š16x æ©¡æœ¨åŸæœ¨ï¼ˆæš«ä»£ï¼‰
- **é­”åŠ›æ¶ˆè€—**ï¼š2,000
- **æ™‚é–“**ï¼š160 tick (8ç§’)
- **çµæ§‹éœ€æ±‚**ï¼š2 å€‹åŸºåº§ã€1 å€‹æ ¸å¿ƒ

---

### Tier 2 - ä¸­ç´šå„€å¼

#### 3. é­”åŠ›é€é¡çš„ç²¾ç…‰ (`mana_lens_refinement`)
- **ææ–™**ï¼š4x å¥§è¡“åˆé‡‘éŒ ã€4x ç´«æ°´æ™¶ç¢ç‰‡ã€1x ç»ç’ƒ
- **ç”¢å‡º**ï¼š1x æœ›é é¡ï¼ˆæš«ä»£é­”åŠ›é€é¡ï¼‰
- **é­”åŠ›æ¶ˆè€—**ï¼š25,000
- **æ™‚é–“**ï¼š400 tick (20ç§’)
- **çµæ§‹éœ€æ±‚**ï¼š4 å€‹åŸºåº§ã€1 å€‹æ ¸å¿ƒã€1 å€‹é­”åŠ›å¡”

#### 4. æ•ˆç‡ç¬¦æ–‡çš„åˆ»å° (`efficiency_rune_inscription`)
- **ææ–™**ï¼š1x é»‘æ›œçŸ³ã€4x å¥§è¡“åˆé‡‘éŒ ã€4x ç´…çŸ³
- **ç”¢å‡º**ï¼š1x æ·±æ¿å²©ç£šï¼ˆæš«ä»£ç¬¦æ–‡çŸ³ï¼‰
- **é­”åŠ›æ¶ˆè€—**ï¼š50,000
- **æ™‚é–“**ï¼š600 tick (30ç§’)
- **çµæ§‹éœ€æ±‚**ï¼š1 å€‹åŸºåº§ã€1 å€‹æ ¸å¿ƒ

---

### Tier 3 - é«˜ç´šå„€å¼

#### 5. æ˜Ÿè¾°é‡‘å±¬çš„é›é€  (`starmetal_forging`)
- **ææ–™**ï¼š1x ä¸‹ç•Œä¹‹æ˜Ÿã€4x ä¸‹ç•Œåˆé‡‘éŒ ã€8x æœ›é é¡
- **ç”¢å‡º**ï¼š2x ä¸‹ç•Œåˆé‡‘éŒ ï¼ˆæš«ä»£æ˜Ÿè¾°é‡‘å±¬ï¼‰
- **é­”åŠ›æ¶ˆè€—**ï¼š500,000
- **æ™‚é–“**ï¼š1200 tick (60ç§’)
- **çµæ§‹éœ€æ±‚**ï¼š8 å€‹åŸºåº§ã€1 å€‹æ ¸å¿ƒã€2 å€‹é­”åŠ›å¡”ã€4 å€‹è¿…æ·ç¬¦æ–‡çŸ³

---

### Tier 4 - çµ‚æ¥µå„€å¼

#### 6. ä¸–ç•Œä¹‹å¿ƒ (`heart_of_the_world`)
- **ææ–™**ï¼š1x é¾è›‹ã€1x æµ·æ´‹ä¹‹å¿ƒã€1x ä¸‹ç•Œåˆé‡‘å¡Šã€4x é‘½çŸ³å¡Š
- **ç”¢å‡º**ï¼š1x ä¿¡æ¨™ï¼ˆæš«ä»£ä¸–ç•Œä¹‹å¿ƒï¼‰
- **é­”åŠ›æ¶ˆè€—**ï¼š10,000,000 (10M)
- **æ™‚é–“**ï¼š2400 tick (120ç§’ / 2åˆ†é˜)
- **çµæ§‹éœ€æ±‚**ï¼š
  - 12 å€‹åŸºåº§
  - 1 å€‹æ ¸å¿ƒ
  - 4 å€‹é­”åŠ›å¡”
  - 4 å€‹æ•ˆç‡ç¬¦æ–‡çŸ³
  - 4 å€‹è¿…æ·ç¬¦æ–‡çŸ³
  - 4 å€‹ç©©å®šç¬¦æ–‡çŸ³
  - 4 å€‹å¢å¹…ç¬¦æ–‡çŸ³

---

### Tier 5 - ç¦å¿Œå„€å¼

#### 7. è™›ç©ºçç çš„è£‚è§£ (`void_pearl_fracture`)
- **ææ–™**ï¼š1x çµ‚ç•Œçç ã€4x ç´«é Œæœ
- **ç”¢å‡º**ï¼š1x è™›ç©ºçç 
- **é­”åŠ›æ¶ˆè€—**ï¼š100,000
- **æ™‚é–“**ï¼š800 tick (40ç§’)
- **å¤±æ•—ç‡**ï¼š30%
- **çµæ§‹éœ€æ±‚**ï¼š4 å€‹åŸºåº§ã€1 å€‹æ ¸å¿ƒ

---

## ğŸ® é…æ–¹ JSON æ ¼å¼ç¯„ä¾‹

ç•¶ä½ åŸ·è¡Œ `runData` å¾Œï¼Œç”Ÿæˆçš„æª”æ¡ˆæ ¼å¼æœƒåƒé€™æ¨£ï¼š

```json
{
  "type": "koniava:ritual",
  "id": "koniava:ritual/arcane_alloy_birth",
  "name": "å¥§è¡“åˆé‡‘çš„èª•ç”Ÿ",
  "tier": "basic",
  "ingredients": [
    { "item": "minecraft:iron_ingot" },
    { "item": "minecraft:iron_ingot" },
    { "item": "minecraft:iron_ingot" },
    { "item": "minecraft:iron_ingot" },
    { "item": "minecraft:lapis_lazuli" },
    { "item": "minecraft:lapis_lazuli" },
    { "item": "minecraft:lapis_lazuli" },
    { "item": "minecraft:lapis_lazuli" }
  ],
  "result": {
    "id": "koniava:mana_ingot",
    "count": 4
  },
  "mana_cost": 5000,
  "ritual_time": 200,
  "structure_requirements": {
    "pedestals": 4,
    "core": 1
  }
}
```

---

## ğŸ”§ é…æ–¹çµæ§‹éœ€æ±‚éµå€¼å°ç…§è¡¨

| éµå€¼ | èªªæ˜ | é©—è­‰é‚è¼¯ä½ç½® |
|------|------|-------------|
| `pedestals` | åŸºåº§ç¸½æ•¸ï¼ˆå·²æ£„ç”¨ï¼Œæ”¹ç”¨æ–¹å‘éµï¼‰ | - |
| `pedestal.north` | åŒ—æ–¹åŸºåº§æ•¸é‡ | `RitualStructureValidator:88` |
| `pedestal.south` | å—æ–¹åŸºåº§æ•¸é‡ | `RitualStructureValidator:88` |
| `pedestal.east` | æ±æ–¹åŸºåº§æ•¸é‡ | `RitualStructureValidator:88` |
| `pedestal.west` | è¥¿æ–¹åŸºåº§æ•¸é‡ | `RitualStructureValidator:88` |
| `pedestal.total` | åŸºåº§ç¸½æ•¸ | `RitualStructureValidator:87` |
| `core` | æ ¸å¿ƒï¼ˆç¸½æ˜¯ 1ï¼‰ | - |
| `pylons` / `pylon.total` | é­”åŠ›å¡”æ•¸é‡ | `RitualStructureValidator:90` |
| `glyph.total` | ç²‰ç­†ç¬¦è™Ÿç¸½æ•¸ | `RitualStructureValidator:129` |
| `glyph.color.<color>` | ç‰¹å®šé¡è‰²ç²‰ç­†æ•¸é‡ | `RitualStructureValidator:136-137` |
| `glyph.pattern.<pattern>` | ç‰¹å®šåœ–æ¡ˆç²‰ç­†æ•¸é‡ | `RitualStructureValidator:139-140` |
| `rune.<type>` | ç‰¹å®šé¡å‹ç¬¦æ–‡çŸ³æ•¸é‡ | `RitualStructureValidator:92` |
| `efficiency_runes` | æ•ˆç‡ç¬¦æ–‡çŸ³ï¼ˆç¯„ä¾‹ç”¨ï¼‰ | - |
| `celerity_runes` | è¿…æ·ç¬¦æ–‡çŸ³ï¼ˆç¯„ä¾‹ç”¨ï¼‰ | - |
| `stability_runes` | ç©©å®šç¬¦æ–‡çŸ³ï¼ˆç¯„ä¾‹ç”¨ï¼‰ | - |
| `augmentation_runes` | å¢å¹…ç¬¦æ–‡çŸ³ï¼ˆç¯„ä¾‹ç”¨ï¼‰ | - |

**æ³¨æ„**ï¼š
- ç›®å‰ `RitualRecipeProvider` ä¸­ä½¿ç”¨çš„éµå€¼ï¼ˆå¦‚ `pedestals`ã€`efficiency_runes`ï¼‰**ä¸å®Œå…¨åŒ¹é…**é©—è­‰å™¨çš„éµå€¼ï¼
- é©—è­‰å™¨ä½¿ç”¨ `pedestal.total`ã€`rune.efficiency` ç­‰æ ¼å¼
- **å»ºè­°ä¿®æ”¹é…æ–¹ç”Ÿæˆå™¨ä½¿ç”¨æ­£ç¢ºçš„éµå€¼**

---

## âš ï¸ ç™¼ç¾çš„ä¸ä¸€è‡´å•é¡Œ

### å•é¡Œï¼šé…æ–¹éµå€¼èˆ‡é©—è­‰å™¨ä¸åŒ¹é…

**é…æ–¹ç”Ÿæˆå™¨ä½¿ç”¨**ï¼š
```java
.structureRequirement("pedestals", 4)  // âŒ éŒ¯èª¤
.structureRequirement("pylons", 1)     // âš ï¸ å¯ç”¨ä½†ä¸æ¨™æº–
.structureRequirement("efficiency_runes", 4)  // âŒ éŒ¯èª¤
```

**é©—è­‰å™¨å¯¦éš›æª¢æŸ¥**ï¼š
```java
summary.put(STRUCTURE_KEY_PEDESTAL, pedestals.size());  // "pedestal.total"
summary.put(STRUCTURE_KEY_PYLON, pylons.size());        // "pylon.total"
summary.put("rune." + type.getName(), count);           // "rune.efficiency"
```

**ä¿®å¾©å»ºè­°**ï¼š
å°‡ `RitualRecipeProvider` ä¸­çš„éµå€¼æ”¹ç‚ºï¼š
```java
.structureRequirement("pedestal.total", 4)
.structureRequirement("pylon.total", 1)
.structureRequirement("rune.efficiency", 4)
.structureRequirement("rune.celerity", 4)
.structureRequirement("rune.stability", 4)
.structureRequirement("rune.augmentation", 4)
```

---

## âœ… ä¸‹ä¸€æ­¥è¡Œå‹•æ¸…å–®

### å¿…é ˆå®Œæˆï¼ˆä¿®å¾© Bugï¼‰
1. âœ… åœ¨ `ModRecipeProvider` åŠ å…¥ `RitualRecipeProvider.generate(recipeOutput)`
2. âœ… ä¿®æ­£é…æ–¹ä¸­çš„ `structure_requirements` éµå€¼
3. âœ… åŸ·è¡Œ `.\gradlew.bat runData` ç”Ÿæˆé…æ–¹ JSON
4. âœ… é©—è­‰ç”Ÿæˆçš„æª”æ¡ˆæ ¼å¼æ­£ç¢º
5. âœ… åŸ·è¡Œ `.\gradlew.bat build` ç¢ºèªç·¨è­¯æˆåŠŸ

### å»ºè­°æ”¹é€²ï¼ˆé¸å¡«ï¼‰
6. â­ æ›´æ–° `RitualRecipeBuilder` çš„å¿«æ·æ–¹æ³•ï¼Œä½¿ç”¨æ­£ç¢ºéµå€¼
7. â­ ç‚ºå„€å¼ç³»çµ±æ·»åŠ  JEI æ•´åˆï¼ˆé…æ–¹æŸ¥çœ‹ï¼‰
8. â­ å¯¦ä½œçœŸæ­£çš„ã€Œæ´»åŒ–æœ¨æã€ã€ã€Œé­”åŠ›é€é¡ã€ç­‰ç‰©å“
9. â­ æ·»åŠ å„€å¼é€²åº¦è¿½è¹¤ GUI
10. â­ å¯¦ä½œç¬¦æ–‡çŸ³çš„å”åŒæ•ˆæœé‚è¼¯

---

## ğŸ“š ç›¸é—œæ–‡ä»¶ç´¢å¼•

- **çµæ§‹æ“ºæ”¾**ï¼š`å€‹äººé–‹ç™¼è€…å°è¨˜éŒ„/ritual/ç¥­å£‡æ“ºæ”¾æ•™å­¸.md`
- **ç¨‹å¼æ¶æ§‹**ï¼š`å€‹äººé–‹ç™¼è€…å°è¨˜éŒ„/ritual/ç¥­å£‡ç¬¦æ–‡ç³»çµ±.md`
- **æŠ€è¡“è¦æ ¼**ï¼š`spec.md` ç¬¬ 2 ç« ã€ç¬¬ 9 ç« 
- **API ç‰ˆæœ¬**ï¼š`api.md` v0.1.20
- **CLAUDE.md**ï¼šå„€å¼ç³»çµ±æ¶æ§‹èªªæ˜

---

## ğŸ¯ ç¸½çµ

å„€å¼ç³»çµ±çš„**æ ¸å¿ƒåŠŸèƒ½å·² 100% å®Œæˆ**ï¼Œåªå·®æœ€å¾Œä¸€æ­¥ï¼š**å•Ÿç”¨é…æ–¹è³‡æ–™ç”Ÿæˆ**ã€‚

ä¿®æ”¹ä¸€è¡Œç¨‹å¼ç¢¼ + åŸ·è¡Œ `runData` å³å¯è®“æ•´å€‹ç³»çµ±é‹ä½œï¼