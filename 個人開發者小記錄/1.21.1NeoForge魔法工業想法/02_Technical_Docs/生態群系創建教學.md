# ğŸŒ Koniavacraft æ–°å¢ç”Ÿç‰©ç¾¤ç³»å®Œæ•´æ”»ç•¥

## ğŸ¯ æ¦‚è¦½

åŸºæ–¼ä½ å„ªåŒ–éçš„ç”Ÿç‰©ç¾¤ç³»ç³»çµ±ï¼Œæ·»åŠ æ–°ç”Ÿç‰©ç¾¤ç³»ç¾åœ¨è®Šå¾—**éå¸¸ç°¡å–®**ï¼æ•´å€‹æµç¨‹åªéœ€è¦ä¿®æ”¹ 4 å€‹åœ°æ–¹ã€‚

---

## ğŸ“‹ æ–°å¢æµç¨‹ç¸½è¦½

```
1ï¸âƒ£ åœ¨ ModBiomes.java å®šç¾©ç”Ÿç‰©ç¾¤ç³»
2ï¸âƒ£ åœ¨ UniversalBiomeRegistration.java è¨»å†Šæ°£å€™
3ï¸âƒ£ åœ¨ CompleteBiomeSurfaceSystem.java æ·»åŠ è™•ç†å™¨
4ï¸âƒ£ å‰µå»ºæ•¸æ“šåŒ…è¨»å†Šï¼ˆå¦‚æœéœ€è¦ï¼‰
```

---

## ğŸ”¥ å¯¦æˆ°ç¯„ä¾‹ï¼šå‰µå»ºã€Œç«å±±ç°åŸã€ç”Ÿç‰©ç¾¤ç³»

è®“æˆ‘å€‘ä¸€æ­¥æ­¥å‰µå»ºä¸€å€‹æ–°çš„ã€Œç«å±±ç°åŸã€ç”Ÿç‰©ç¾¤ç³»ï¼š

### ğŸ”¸ ç¬¬ä¸€æ­¥ï¼šå®šç¾©ç”Ÿç‰©ç¾¤ç³» (ModBiomes.java)

åœ¨ `ModBiomes.java` ä¸­æ·»åŠ ï¼š

```java
// === åœ¨ç¾æœ‰çš„ ResourceKey å®šç¾©å€åŸŸæ·»åŠ  ===
public static final ResourceKey<Biome> VOLCANIC_ASHLANDS = ResourceKey.create(
    Registries.BIOME,
    ResourceLocation.fromNamespaceAndPath(KoniavacraftMod.MOD_ID, "volcanic_ashlands")
);

// === åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å‰µå»ºæ–¹æ³• ===
/**
 * å‰µå»ºç«å±±ç°åŸç”Ÿç‰©ç¾¤ç³»
 */
public static Biome createVolcanicAshlands(HolderGetter<PlacedFeature> placedFeatures,
                                          HolderGetter<ConfiguredWorldCarver<?>> carvers) {
    KoniavacraftMod.LOGGER.info("ğŸŒ‹ æ­£åœ¨å‰µå»ºç«å±±ç°åŸç”Ÿç‰©ç¾¤ç³»...");

    BiomeGenerationSettings.Builder generationSettings = 
        new BiomeGenerationSettings.Builder(placedFeatures, carvers);
    MobSpawnSettings.Builder mobSpawnSettings = new MobSpawnSettings.Builder();

    // ğŸ”¥ æ·»åŠ åŸºç¤ç‰¹å¾µ
    try {
        BiomeDefaultFeatures.addDefaultMonsterRoom(generationSettings);
        BiomeDefaultFeatures.addDefaultOres(generationSettings);
        // ç«å±±åœ°å€ï¼Œä¸è¦è‰åœ°ç‰¹å¾µ
    } catch (Exception e) {
        KoniavacraftMod.LOGGER.warn("è·³éç‰¹å¾µä»¥é¿å…å¾ªç’°è¡çª");
    }

    // ğŸ”¥ ç¨€å°‘çš„ç”Ÿç‰©ç”Ÿæˆï¼ˆæƒ¡åŠ£ç’°å¢ƒï¼‰
    mobSpawnSettings.addSpawn(MobCategory.MONSTER,
        new MobSpawnSettings.SpawnerData(EntityType.MAGMA_CUBE, 4, 2, 4));
    mobSpawnSettings.addSpawn(MobCategory.MONSTER,
        new MobSpawnSettings.SpawnerData(EntityType.BLAZE, 2, 1, 2));
    
    return new Biome.BiomeBuilder()
        .temperature(1.5f)                    // ğŸ”¥ å¾ˆç†±
        .downfall(0.1f)                       // ğŸœï¸ å¾ˆä¹¾ç‡¥
        .hasPrecipitation(false)              // âŒ ä¸ä¸‹é›¨
        .temperatureAdjustment(Biome.TemperatureModifier.NONE)
        .specialEffects(createVolcanicAshlandsEffects())
        .mobSpawnSettings(mobSpawnSettings.build())
        .generationSettings(generationSettings.build())
        .build();
}

/**
 * ç«å±±ç°åŸè¦–è¦ºæ•ˆæœ
 */
private static BiomeSpecialEffects createVolcanicAshlandsEffects() {
    return new BiomeSpecialEffects.Builder()
        .waterColor(0x8B4513)           // ğŸŸ¤ è¤è‰²æ°´ï¼ˆè¢«ç°å¡µæ±¡æŸ“ï¼‰
        .waterFogColor(0x654321)        // ğŸŸ« æ·±è¤è‰²æ°´éœ§
        .skyColor(0xD2691E)             // ğŸ§¡ æ©™è¤è‰²å¤©ç©º
        .fogColor(0x696969)             // ğŸŒ«ï¸ ç°è‰²éœ§æ°£
        .grassColorOverride(0x8B7D6B)   // ğŸŸ« æ¯é»ƒçš„è‰
        .foliageColorOverride(0x8B7355) // ğŸ‚ è¤è‰²æ¤è¢«
        .ambientMoodSound(AmbientMoodSettings.LEGACY_CAVE_SETTINGS)
        .build();
}
```

### ğŸ”¸ ç¬¬äºŒæ­¥ï¼šè¨»å†Šæ°£å€™é…ç½® (UniversalBiomeRegistration.java)

åœ¨ `registerAllBiomes()` æ–¹æ³•ä¸­æ·»åŠ ï¼š

```java
private static void registerAllBiomes() {
    // ... ç¾æœ‰çš„é­”åŠ›è‰åŸè¨»å†Š ...

    // ğŸ”¥ ç«å±±ç°åŸ - ç¨€æœ‰çš„æ¥µç«¯ç’°å¢ƒ
    UniversalBiomeInjector.registerBiome(
        ModBiomes.VOLCANIC_ASHLANDS,
        UniversalBiomeInjector.ClimateConfig.builder()
            .temperature(1.0F, 1.8F)         // ğŸ”¥ æ¥µç†±
            .humidity(-0.8F, 0.1F)           // ğŸœï¸ æ¥µä¹¾ç‡¥
            .continentalness(0.3F, 0.8F)     // ğŸ”ï¸ å…§é™¸
            .erosion(0.2F, 0.7F)             // ğŸŒ‹ é«˜ä¾µè•ï¼ˆç«å±±æ´»å‹•ï¼‰
            .depth(-0.1F, 0.4F)              // ğŸ”ï¸ å¹³åœ°åˆ°å°å±±
            .weirdness(0.4F, 1.2F)           // ğŸŒ€ é«˜æ€ªç•°åº¦ï¼ˆç¨€æœ‰ï¼‰
            .build(),
        3, // ä½æ¬Šé‡ï¼Œç¨€æœ‰ç”Ÿç‰©ç¾¤ç³»
        "è¢«ç«å±±ç°è¦†è“‹çš„è’æ¶¼åŸé‡"
    );

    KoniavacraftMod.LOGGER.info("ğŸ“ ç”Ÿç‰©ç¾¤è½è¨»å†Šå®Œæˆï¼");
}
```

### ğŸ”¸ ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ åœ°è¡¨è™•ç†å™¨ (CompleteBiomeSurfaceSystem.java)

#### 3.1 å‰µå»ºè™•ç†å™¨é¡

åœ¨ `CompleteBiomeSurfaceSystem.java` ä¸­æ·»åŠ æ–°çš„è™•ç†å™¨ï¼š

```java
/**
 * ğŸ”¥ ç«å±±ç°åŸè™•ç†å™¨
 */
public static class VolcanicAshlandsBiomeProcessor implements BiomeProcessor {
    @Override
    public boolean canProcess(ServerLevel level, ChunkAccess chunk) {
        return BlockReplacementUtils.isBiomeFast(level, chunk, ModBiomes.VOLCANIC_ASHLANDS);
    }

    @Override
    public int processChunk(ServerLevel level, ChunkAccess chunk) {
        return BlockReplacementUtils.replace(level, chunk, ModBiomes.VOLCANIC_ASHLANDS,
            BlockReplacementUtils.rules(
                Blocks.GRASS_BLOCK, Blocks.COARSE_DIRT,  // è‰åœ° â†’ ç²—æ³¥
                Blocks.DIRT, Blocks.COARSE_DIRT,         // æ³¥åœŸ â†’ ç²—æ³¥
                Blocks.STONE, Blocks.BASALT,             // çŸ³é ­ â†’ ç„æ­¦å²©
                Blocks.WATER, Blocks.LAVA                // æ°´ â†’ å²©æ¼¿ï¼
            ),
            BlockReplacementUtils.conditions(
                Blocks.SAND, BlockReplacementUtils.chance(0.3f) // 30%æ©Ÿç‡æ›¿æ›æ²™å­
            )
        );
    }
}
```

#### 3.2 è¨»å†Šè™•ç†å™¨

åœ¨ `static {}` å€å¡Šä¸­è¨»å†Šï¼š

```java
static {
    // ğŸŒ± ç¾æœ‰çš„é­”åŠ›è‰åŸè™•ç†å™¨
    registerBiomeProcessor(ModBiomes.MANA_PLAINS, new ManaPlainsBiomeProcessor());
    
    // ğŸ”¥ æ–°å¢ï¼šç«å±±ç°åŸè™•ç†å™¨
    registerBiomeProcessor(ModBiomes.VOLCANIC_ASHLANDS, new VolcanicAshlandsBiomeProcessor());
}
```

### ğŸ”¸ ç¬¬å››æ­¥ï¼šæ•¸æ“šåŒ…è¨»å†Š

å¦‚æœä½ æœ‰æ•¸æ“šç”Ÿæˆå™¨ï¼Œåœ¨ä½ çš„ `ModBiomeProvider` ä¸­æ·»åŠ ï¼š

```java
// åœ¨ RegistrySetBuilder ä¸­æ·»åŠ 
.add(Registries.BIOME, bootstrap -> {
    HolderGetter<PlacedFeature> placedFeatures = bootstrap.lookup(Registries.PLACED_FEATURE);
    HolderGetter<ConfiguredWorldCarver<?>> carvers = bootstrap.lookup(Registries.CONFIGURED_CARVER);
    
    // ç¾æœ‰çš„é­”åŠ›è‰åŸ
    bootstrap.register(ModBiomes.MANA_PLAINS, 
        ModBiomes.createManaPlains(placedFeatures, carvers));
    
    // ğŸ”¥ æ–°å¢ï¼šç«å±±ç°åŸ
    bootstrap.register(ModBiomes.VOLCANIC_ASHLANDS, 
        ModBiomes.createVolcanicAshlands(placedFeatures, carvers));
});
```

---

## ğŸ¨ è‡ªå®šç¾©ç”Ÿç‰©ç¾¤ç³»è¨­è¨ˆæŒ‡å—

### ğŸŒˆ **é¡è‰²é…ç½®å»ºè­°**

```java
// ğŸŒ¿ æ£®æ—ç³»ç”Ÿç‰©ç¾¤ç³»
.waterColor(0x3F76E4)      // æ¸…æ¾ˆè—æ°´
.skyColor(0x78A7FF)       // æ˜äº®å¤©ç©º
.grassColorOverride(0x48B518) // ç¿ ç¶ è‰åœ°

// ğŸœï¸ æ²™æ¼ ç³»ç”Ÿç‰©ç¾¤ç³»  
.waterColor(0xB8860B)      // é‡‘è‰²æ°´
.skyColor(0xFFA500)       // æ©™è‰²å¤©ç©º
.grassColorOverride(0xD2B48C) // æ²™è‰²è‰

// â„ï¸ å†°é›ªç³»ç”Ÿç‰©ç¾¤ç³»
.waterColor(0x4682B4)      // å†°è—æ°´
.skyColor(0xE6E6FA)       // æ·¡ç´«å¤©ç©º
.grassColorOverride(0xE0FFFF) // é›ªç™½è‰

// ğŸŒ‹ ç«å±±ç³»ç”Ÿç‰©ç¾¤ç³»
.waterColor(0x8B4513)      // è¤è‰²æ°´
.skyColor(0xD2691E)       // æ©™è¤å¤©ç©º
.grassColorOverride(0x8B7D6B) // æ¯é»ƒè‰

// ğŸ”® é­”æ³•ç³»ç”Ÿç‰©ç¾¤ç³»
.waterColor(0x9932CC)      // ç´«è‰²æ°´
.skyColor(0xDA70D6)       // è˜­èŠ±ç´«å¤©ç©º
.grassColorOverride(0xBA55D3) // é­”æ³•ç´«è‰
```

### ğŸŒ¡ï¸ **æ°£å€™åƒæ•¸æŒ‡å—**

```java
// ğŸŒ¿ å¸¸è¦‹ç”Ÿç‰©ç¾¤ç³»ï¼ˆé«˜æ¬Šé‡ 6-8ï¼‰
.temperature(0.3F, 0.8F)
.humidity(0.3F, 0.8F)
.depth(0.0F, 0.3F)        // åœ°é¢å±¤
.weirdness(-0.3F, 0.3F)   // æ­£å¸¸

// ğŸ”ï¸ ç¨€æœ‰ç”Ÿç‰©ç¾¤ç³»ï¼ˆä½æ¬Šé‡ 2-4ï¼‰
.temperature(-0.5F, 1.5F) // æ¥µç«¯æº«åº¦
.humidity(-0.8F, 1.2F)    // æ¥µç«¯æ¿•åº¦
.depth(0.3F, 0.8F)        // é«˜æµ·æ‹”
.weirdness(0.5F, 1.5F)    // é«˜æ€ªç•°åº¦

// ğŸŒ‹ è¶…ç¨€æœ‰ç”Ÿç‰©ç¾¤ç³»ï¼ˆæ¬Šé‡ 1-2ï¼‰
.temperature(1.0F, 2.0F)  // æ¥µç†±
.humidity(-1.0F, 0.0F)    // æ¥µä¹¾
.depth(-0.3F, 0.8F)       // å¤šè®Šåœ°å½¢
.weirdness(0.8F, 2.0F)    // æ¥µé«˜æ€ªç•°åº¦
```

### ğŸ® **ç”Ÿç‰©ç”Ÿæˆå»ºè­°**

```java
// ğŸ•Šï¸ å’Œå¹³ç”Ÿç‰©ç¾¤ç³»
mobSpawnSettings.addSpawn(MobCategory.CREATURE,
    new MobSpawnSettings.SpawnerData(EntityType.COW, 8, 4, 4));
mobSpawnSettings.addSpawn(MobCategory.CREATURE,
    new MobSpawnSettings.SpawnerData(EntityType.SHEEP, 12, 4, 4));

// âš”ï¸ å±éšªç”Ÿç‰©ç¾¤ç³»
mobSpawnSettings.addSpawn(MobCategory.MONSTER,
    new MobSpawnSettings.SpawnerData(EntityType.ZOMBIE, 100, 4, 4));
mobSpawnSettings.addSpawn(MobCategory.MONSTER,
    new MobSpawnSettings.SpawnerData(EntityType.SKELETON, 100, 4, 4));

// ğŸ”¥ æ¥µç«¯ç’°å¢ƒ
mobSpawnSettings.addSpawn(MobCategory.MONSTER,
    new MobSpawnSettings.SpawnerData(EntityType.MAGMA_CUBE, 4, 2, 4));
mobSpawnSettings.addSpawn(MobCategory.MONSTER,
    new MobSpawnSettings.SpawnerData(EntityType.BLAZE, 2, 1, 2));

// â„ï¸ å¯’å†·ç’°å¢ƒ
mobSpawnSettings.addSpawn(MobCategory.CREATURE,
    new MobSpawnSettings.SpawnerData(EntityType.POLAR_BEAR, 1, 1, 2));
```

---

## ğŸš€ å¿«é€Ÿæ·»åŠ æ¨¡æ¿

### ğŸ¯ **è¤‡è£½é€™å€‹æ¨¡æ¿å¿«é€Ÿæ·»åŠ æ–°ç”Ÿç‰©ç¾¤ç³»**

```java
// ğŸ”¸ 1. ModBiomes.java - ResourceKey
public static final ResourceKey<Biome> YOUR_BIOME = ResourceKey.create(
    Registries.BIOME,
    ResourceLocation.fromNamespaceAndPath(KoniavacraftMod.MOD_ID, "your_biome")
);

// ğŸ”¸ 2. ModBiomes.java - å‰µå»ºæ–¹æ³•
public static Biome createYourBiome(HolderGetter<PlacedFeature> placedFeatures,
                                    HolderGetter<ConfiguredWorldCarver<?>> carvers) {
    // TODO: å¯¦ç¾ä½ çš„ç”Ÿç‰©ç¾¤ç³»é‚è¼¯
    return new Biome.BiomeBuilder()
        .temperature(0.7f)
        .downfall(0.6f)
        .hasPrecipitation(true)
        .temperatureAdjustment(Biome.TemperatureModifier.NONE)
        .specialEffects(createYourBiomeEffects())
        .mobSpawnSettings(new MobSpawnSettings.Builder().build())
        .generationSettings(new BiomeGenerationSettings.Builder(placedFeatures, carvers).build())
        .build();
}

// ğŸ”¸ 3. UniversalBiomeRegistration.java - è¨»å†Š
UniversalBiomeInjector.registerBiome(
    ModBiomes.YOUR_BIOME,
    UniversalBiomeInjector.ClimateConfig.builder()
        .temperature(0.5F, 0.8F)
        .humidity(0.4F, 0.7F)
        .continentalness(0.0F, 0.3F)
        .erosion(-0.2F, 0.2F)
        .depth(0.0F, 0.4F)
        .weirdness(-0.3F, 0.3F)
        .build(),
    5, // æ¬Šé‡
    "ä½ çš„ç”Ÿç‰©ç¾¤ç³»æè¿°"
);

// ğŸ”¸ 4. CompleteBiomeSurfaceSystem.java - è™•ç†å™¨
public static class YourBiomeProcessor implements BiomeProcessor {
    @Override
    public boolean canProcess(ServerLevel level, ChunkAccess chunk) {
        return BlockReplacementUtils.isBiomeFast(level, chunk, ModBiomes.YOUR_BIOME);
    }

    @Override
    public int processChunk(ServerLevel level, ChunkAccess chunk) {
        return BlockReplacementUtils.replace(level, chunk, ModBiomes.YOUR_BIOME,
            BlockReplacementUtils.rules(
                Blocks.GRASS_BLOCK, Blocks.MYCELIUM  // ç¤ºä¾‹æ›¿æ›
            )
        );
    }
}

// ğŸ”¸ 5. CompleteBiomeSurfaceSystem.java - è¨»å†Šè™•ç†å™¨
static {
    registerBiomeProcessor(ModBiomes.YOUR_BIOME, new YourBiomeProcessor());
}
```

---

## ğŸ”§ é€²éšæŠ€å·§

### ğŸ’¡ **æ¢ä»¶æ›¿æ›ç¯„ä¾‹**

```java
// ğŸŒŠ åªåœ¨é è¿‘æ°´æºæ™‚æ›¿æ›
BlockReplacementUtils.conditions(
    Blocks.SAND, BlockReplacementUtils.nearWater(3)
)

// ğŸ² éš¨æ©Ÿæ›¿æ›ï¼ˆ30%æ©Ÿç‡ï¼‰
BlockReplacementUtils.conditions(
    Blocks.STONE, BlockReplacementUtils.chance(0.3f)
)

// ğŸ”ï¸ åªåœ¨åœ°è¡¨æ›¿æ›
BlockReplacementUtils.conditions(
    Blocks.DIRT, BlockReplacementUtils.SURFACE_ONLY
)

// ğŸŒŠ åªåœ¨æ·±å±¤æ›¿æ›
BlockReplacementUtils.conditions(
    Blocks.STONE, BlockReplacementUtils.DEEP_UNDERGROUND
)
```

### ğŸ¨ **çµ„åˆæ¢ä»¶**

```java
// ğŸŒŠ + ğŸ² è¤‡åˆæ¢ä»¶ï¼šé è¿‘æ°´æºä¸”æœ‰30%æ©Ÿç‡
BlockReplacementUtils.conditions(
    Blocks.SAND, 
    BlockReplacementUtils.nearWater(2).and(BlockReplacementUtils.chance(0.3f))
)
```

---

## ğŸ¯ æ¸¬è©¦èˆ‡é™¤éŒ¯

### ğŸ” **å¦‚ä½•æ¸¬è©¦æ–°ç”Ÿç‰©ç¾¤ç³»**

1. **å•Ÿå‹•éŠæˆ²æŸ¥çœ‹æ—¥èªŒ**ï¼š
   ```
   [INFO] ğŸ“ è¨»å†Šç”Ÿç‰©ç¾¤ç³»è™•ç†å™¨: koniava:your_biome
   ```

2. **ä½¿ç”¨æŒ‡ä»¤å°‹æ‰¾**ï¼š
   ```
   /locatebiome koniava:your_biome
   ```

3. **è§€å¯Ÿè™•ç†æ—¥èªŒ**ï¼š
   ```
   [DEBUG] ğŸ“‹ æ·»åŠ ç”Ÿç‰©ç¾¤ç³»è™•ç†ä»»å‹™: your_biome at (12, 34)
   [DEBUG] âœ… è™•ç†å®Œæˆ: your_biome at (12, 34), æ›¿æ›42å€‹æ–¹å¡Š
   ```

### ğŸš¨ **å¸¸è¦‹å•é¡Œè§£æ±º**

- **ç”Ÿç‰©ç¾¤ç³»ä¸ç”Ÿæˆ** â†’ æª¢æŸ¥æ°£å€™åƒæ•¸æ˜¯å¦åˆç†
- **åœ°è¡¨ä¸æ›¿æ›** â†’ ç¢ºèªè™•ç†å™¨å·²è¨»å†Š
- **éŠæˆ²å´©æ½°** â†’ æª¢æŸ¥æ–¹å¡Šæ˜¯å¦å­˜åœ¨ï¼Œimport æ˜¯å¦æ­£ç¢º
- **æ‰¾ä¸åˆ°ç”Ÿç‰©ç¾¤ç³»** â†’ èª¿æ•´æ¬Šé‡æˆ–æ°£å€™ç¯„åœ

---

## ğŸ‰ ç¸½çµ

ç¾åœ¨ä½ æœ‰äº†ï¼š
- âœ… **å®Œæ•´çš„æ·»åŠ æµç¨‹** - 4æ­¥é©Ÿè¼•é¬†æå®š
- âœ… **å¯¦æˆ°ç¯„ä¾‹** - ç«å±±ç°åŸç”Ÿç‰©ç¾¤ç³»
- âœ… **è¨­è¨ˆæŒ‡å—** - é¡è‰²ã€æ°£å€™ã€ç”Ÿç‰©é…ç½®
- âœ… **å¿«é€Ÿæ¨¡æ¿** - è¤‡è£½è²¼ä¸Šå³å¯ä½¿ç”¨
- âœ… **é€²éšæŠ€å·§** - æ¢ä»¶æ›¿æ›å’Œçµ„åˆé‚è¼¯

**æœ‰äº†é€™å¥—å„ªåŒ–éçš„ç³»çµ±ï¼Œæ·»åŠ æ–°ç”Ÿç‰©ç¾¤ç³»å°±åƒæ­ç©æœ¨ä¸€æ¨£ç°¡å–®ï¼** ğŸ§©âœ¨

ä½ æƒ³å…ˆè©¦è©¦å‰µå»ºå“ªå€‹ç”Ÿç‰©ç¾¤ç³»å‘¢ï¼Ÿ